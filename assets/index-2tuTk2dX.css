*,*:before,*:after{margin:0;padding:0;box-sizing:border-box}:root{--accent: #6C5CE7;--accent-dark: #5A4BD1;--accent-light: rgba(108, 92, 231, .12);--accent-glow: rgba(108, 92, 231, .3);--bg: #F8F9FA;--bg-secondary: #FFFFFF;--surface: #FFFFFF;--surface-raised: #FFFFFF;--text: #1A1A2E;--text-secondary: #6B7280;--text-tertiary: #9CA3AF;--border: #E5E7EB;--border-light: #F3F4F6;--success: #10B981;--success-light: rgba(16, 185, 129, .12);--danger: #EF4444;--danger-light: rgba(239, 68, 68, .12);--warning: #F59E0B;--warning-light: rgba(245, 158, 11, .12);--cell-filled: #1B2838;--cell-filled-complete: #1B2838;--diff-beginner: #10B981;--diff-easy: #6C5CE7;--diff-medium: #8B5CF6;--diff-hard: #F97316;--shadow-sm: 0 1px 2px rgba(0, 0, 0, .05);--shadow-md: 0 4px 12px rgba(0, 0, 0, .08);--shadow-lg: 0 8px 24px rgba(0, 0, 0, .12);--shadow-accent: 0 4px 16px rgba(108, 92, 231, .25);--safe-bottom: env(safe-area-inset-bottom, 0px);--radius-sm: 8px;--radius-md: 12px;--radius-lg: 16px;--radius-xl: 20px}[data-theme=dark]{--accent: #7C6CF0;--accent-dark: #6C5CE7;--accent-light: rgba(124, 108, 240, .15);--accent-glow: rgba(124, 108, 240, .35);--bg: #1A1A2E;--bg-secondary: #16213E;--surface: #1E2A45;--surface-raised: #253352;--text: #E2E8F0;--text-secondary: #94A3B8;--text-tertiary: #64748B;--border: #2D3A56;--border-light: #253352;--success-light: rgba(16, 185, 129, .2);--danger-light: rgba(239, 68, 68, .2);--warning-light: rgba(245, 158, 11, .2);--cell-filled: #E2E8F0;--cell-filled-complete: #E2E8F0;--shadow-sm: 0 1px 2px rgba(0, 0, 0, .2);--shadow-md: 0 4px 12px rgba(0, 0, 0, .3);--shadow-lg: 0 8px 24px rgba(0, 0, 0, .4);--shadow-accent: 0 4px 16px rgba(124, 108, 240, .3)}html,body{height:100%;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,sans-serif;background:var(--bg);color:var(--text);overflow:hidden;touch-action:manipulation;-webkit-tap-highlight-color:transparent;-webkit-font-smoothing:antialiased;transition:background-color .3s ease,color .3s ease}#root{height:100%}.home-screen{display:flex;flex-direction:column;height:100%;max-width:500px;margin:0 auto;background:var(--bg);overflow-y:auto;-webkit-overflow-scrolling:touch}.home-header{text-align:center;padding:44px 20px 18px;background:var(--surface);position:relative}.home-header:after{content:"";position:absolute;bottom:0;left:20px;right:20px;height:1px;background:linear-gradient(90deg,transparent,var(--border),transparent)}.app-title-row{display:flex;align-items:center;justify-content:center;gap:10px}.app-title{font-size:26px;font-weight:800;letter-spacing:-.5px;color:var(--text)}.app-subtitle{font-size:13px;color:var(--text-tertiary);margin-top:4px;letter-spacing:.5px;text-transform:uppercase;font-weight:600}.hint-balance{position:absolute;top:16px;right:20px;display:flex;align-items:center;gap:6px;background:var(--accent-light);padding:6px 14px;border-radius:var(--radius-xl);font-size:14px;font-weight:700;transition:all .2s}.hint-balance-icon{display:flex;align-items:center;color:var(--accent)}.hint-balance-count{color:var(--accent)}.home-tab-bar{display:flex;background:var(--surface);padding:0 20px;gap:0;position:sticky;top:0;z-index:10;border-bottom:1px solid var(--border-light)}.home-tab-bar:after{display:none}.home-tab{flex:1;padding:12px 0;background:none;border:none;border-bottom:2.5px solid transparent;font-size:15px;font-weight:600;color:var(--text-tertiary);cursor:pointer;transition:all .2s;text-align:center;display:flex;align-items:center;justify-content:center;gap:6px;min-height:44px}.home-tab.active{color:var(--accent);border-bottom-color:var(--accent)}.stats-line{display:flex;align-items:center;justify-content:space-between;padding:10px 20px;margin:8px 16px;background:var(--surface);border-radius:var(--radius-lg);box-shadow:var(--shadow-sm)}.stats-line-text{font-size:14px;font-weight:600;color:var(--text-secondary)}.stats-line-hint{display:flex;align-items:center;gap:5px;padding:5px 12px;background:var(--accent-light);border:none;border-radius:var(--radius-xl);cursor:pointer;font-size:14px;font-weight:700;color:var(--accent);transition:all .15s;min-height:44px}.stats-line-hint:active{transform:scale(.95);background:var(--accent-glow)}.hint-modal-redesign{padding:24px 20px 20px}.hint-modal-header{text-align:center;margin-bottom:20px}.hint-modal-icon-large{font-size:40px;margin-bottom:8px}.hint-modal-balance{font-size:14px;color:var(--text-secondary);margin-top:4px}.hint-modal-balance strong{color:var(--accent);font-size:18px}.hint-modal-cards{display:flex;flex-direction:column;gap:10px;margin-bottom:8px}.hint-card{display:flex;align-items:center;gap:14px;padding:16px;background:var(--bg);border:1.5px solid var(--border-light);border-radius:var(--radius-lg);cursor:pointer;transition:all .15s;width:100%}.hint-card:active:not(.disabled){transform:scale(.97);border-color:var(--accent);background:var(--accent-light)}.hint-card.disabled{opacity:.5;cursor:not-allowed}.hint-card-icon{display:flex;align-items:center;justify-content:center;width:48px;height:48px;border-radius:var(--radius-md);background:var(--accent-light);flex-shrink:0}.hint-card-info{flex:1;display:flex;flex-direction:column;gap:2px;text-align:left}.hint-card-title{font-size:15px;font-weight:700;color:var(--text)}.hint-card-price{font-size:13px;color:var(--text-secondary)}.hint-card-limit{font-size:11px;color:var(--text-tertiary);margin-top:2px}.hint-card-reward{font-size:18px;font-weight:800;color:var(--accent);background:var(--accent-light);padding:6px 14px;border-radius:var(--radius-md);flex-shrink:0}.home-body{flex:1;padding-bottom:80px}.level-section-group{margin:0 16px 20px;animation:sectionFadeIn .4s cubic-bezier(.16,1,.3,1) both}.level-section-group:nth-child(3){animation-delay:.15s}.level-section-group:nth-child(4){animation-delay:.25s}.level-section-group:nth-child(5){animation-delay:.35s}.level-section-group:nth-child(6){animation-delay:.45s}@keyframes sectionFadeIn{0%{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}.section-title{font-size:14px;font-weight:700;margin-bottom:10px;display:flex;align-items:center;gap:8px}.section-size{font-size:11px;opacity:.5;font-weight:600;background:var(--border-light);padding:2px 8px;border-radius:var(--radius-sm);color:var(--text-secondary)}.level-row{display:grid;grid-template-columns:repeat(5,1fr);gap:8px}.level-btn{border:none;border-radius:var(--radius-md);background:var(--surface);font-size:15px;font-weight:700;cursor:pointer;transition:all .2s cubic-bezier(.25,.46,.45,.94);box-shadow:var(--shadow-sm);color:var(--text);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:2px;padding:4px 2px;position:relative;min-width:44px;min-height:44px;aspect-ratio:auto}.level-btn-number{font-size:15px;font-weight:700;line-height:1.2;display:flex;align-items:center;justify-content:center}.level-btn-time{font-size:9px;font-weight:500;color:var(--text-secondary);line-height:1;font-variant-numeric:tabular-nums}.level-btn-stars{font-size:8px;line-height:1;display:flex;gap:1px}@media(hover:hover){.level-btn:hover:not(:disabled){transform:translateY(-2px);box-shadow:var(--shadow-md)}.level-btn.completed:hover{box-shadow:0 4px 16px #10b9814d}.level-btn.current:hover{box-shadow:0 4px 20px var(--accent-glow)}}.level-btn:active:not(:disabled){transform:scale(.92);transition-duration:.1s}.level-btn.completed{background:var(--surface);color:var(--text);box-shadow:var(--shadow-sm);border:1.5px solid var(--border-light);padding:5px 3px 3px}.level-btn.completed .level-btn-time{color:var(--text-tertiary);font-size:8px}.level-btn.completed .level-btn-stars{color:var(--text-secondary)}.level-btn-completed-info{display:flex;flex-direction:column;align-items:center;gap:0px}.level-btn-name{font-size:7px;font-weight:500;color:var(--text-tertiary);line-height:1;max-width:48px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mini-puzzle-art{border:1px solid var(--border-light)}.level-btn.current{background:linear-gradient(135deg,var(--accent),var(--accent-dark));color:#fff;box-shadow:var(--shadow-accent);animation:pulse-btn 2s ease-in-out infinite}.level-btn.locked{background:var(--bg);color:var(--text-tertiary);cursor:not-allowed;box-shadow:none;font-size:12px}@keyframes pulse-btn{0%,to{box-shadow:var(--shadow-accent)}50%{box-shadow:0 4px 24px var(--accent-glow)}}.collection-view{padding:12px 16px}.collection-section{margin-bottom:12px}.collection-section-header{display:flex;align-items:center;justify-content:space-between;padding:10px 14px;background:var(--surface);border-radius:var(--radius-lg);cursor:pointer;-webkit-tap-highlight-color:transparent;transition:all .2s;margin-bottom:8px;box-shadow:var(--shadow-sm)}.collection-section-header:active{transform:scale(.98)}.collection-section-header.collapsed{margin-bottom:0;opacity:.7}.collection-section-left{display:flex;flex-direction:column;gap:2px}.collection-section-label{font-size:15px;font-weight:800;color:var(--text)}.collection-section-desc{font-size:11px;color:var(--text-tertiary)}.collection-section-right{display:flex;align-items:center;gap:6px}.collection-section-badge{font-size:14px}.collection-section-count{font-size:13px;font-weight:700;min-width:18px;text-align:center}.collection-section-chevron{font-size:14px;color:var(--text-tertiary);transition:transform .2s}.collection-section-chevron.collapsed{transform:rotate(-90deg)}.collection-section-content{animation:sectionExpand .2s ease both}@keyframes sectionExpand{0%{opacity:0;transform:translateY(-4px)}to{opacity:1;transform:translateY(0)}}.collection-grid-compact{display:flex;flex-direction:column;gap:8px}.collection-compact-card{display:flex;align-items:center;gap:12px;background:var(--surface);border-radius:var(--radius-lg);padding:12px 14px;box-shadow:var(--shadow-sm);cursor:pointer;transition:all .2s;border:1.5px solid transparent;-webkit-tap-highlight-color:transparent}.collection-compact-card:active{transform:scale(.98)}.collection-compact-card.expanded{border-color:var(--collection-color, var(--accent));box-shadow:var(--shadow-md)}.collection-compact-card.completed{background:var(--surface);border-color:var(--success-light)}.collection-compact-card:not(.completed):not(.expanded){opacity:.85}.collection-compact-info{flex:1;min-width:0}.collection-compact-top{display:flex;align-items:center;justify-content:space-between;gap:6px;margin-bottom:2px}.collection-compact-name{font-size:15px;font-weight:700;color:var(--text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.collection-compact-badge{font-size:14px;flex-shrink:0}.collection-compact-meta{display:flex;align-items:center;margin-bottom:6px}.collection-compact-progress{display:flex;align-items:center;gap:8px}.collection-compact-progress-bar{flex:1;height:5px;background:var(--bg);border-radius:3px;overflow:hidden}.collection-compact-progress-fill{height:100%;border-radius:3px;transition:width .5s cubic-bezier(.16,1,.3,1)}.collection-compact-progress-text{font-size:12px;font-weight:700;min-width:32px;text-align:right;font-variant-numeric:tabular-nums}.collection-expanded-view{background:var(--surface);border-radius:0 0 var(--radius-lg) var(--radius-lg);padding:0 14px 16px;margin-top:-6px;animation:expandSlide .3s ease both}@keyframes expandSlide{0%{opacity:0;max-height:0;padding-top:0;padding-bottom:0}to{opacity:1;max-height:500px;padding-top:8px;padding-bottom:16px}}.collection-expanded-desc{text-align:center;font-size:13px;color:var(--text-secondary);margin-top:8px}.collection-card{background:var(--surface);border-radius:var(--radius-lg);padding:18px;margin-bottom:14px;box-shadow:var(--shadow-sm)}.collection-card-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px}.collection-card-info{display:flex;align-items:flex-start;gap:12px}.collection-emoji{font-size:32px;line-height:1;width:48px;height:48px;display:flex;align-items:center;justify-content:center;border-radius:var(--radius-md);background:var(--bg)}.collection-name{font-size:17px;font-weight:700;margin-bottom:2px}.collection-desc{font-size:13px;color:var(--text-secondary)}.collection-badge{background:linear-gradient(135deg,var(--success),#059669);color:#fff;font-size:11px;font-weight:700;padding:4px 12px;border-radius:var(--radius-xl);white-space:nowrap;box-shadow:0 2px 8px #10b98140}.collection-progress{display:flex;align-items:center;gap:10px;margin-bottom:16px}.collection-progress-bar{flex:1;height:6px;background:var(--bg);border-radius:3px;overflow:hidden}.collection-progress-fill{height:100%;border-radius:3px;transition:width .5s cubic-bezier(.16,1,.3,1)}.collection-progress-text{font-size:13px;font-weight:700;min-width:40px;text-align:right;font-variant-numeric:tabular-nums}.collection-grid{display:grid;gap:8px;justify-items:center}.collection-tile{display:flex;flex-direction:column;align-items:center;gap:4px}.collection-tile-level{font-size:10px;color:var(--text-secondary);font-weight:600}.mini-grid{border:1px solid var(--border);transition:opacity .3s,filter .3s}.game-screen{display:flex;flex-direction:column;height:100%;max-width:500px;margin:0 auto;background:var(--bg)}.game-header{display:flex;justify-content:space-between;align-items:center;padding:4px 10px;background:var(--surface);gap:4px;position:relative}.game-header:after{content:"";position:absolute;bottom:0;left:12px;right:12px;height:1px;background:linear-gradient(90deg,transparent,var(--border),transparent)}.back-btn{display:flex;align-items:center;justify-content:center;width:36px;height:36px;background:var(--bg);border:none;cursor:pointer;border-radius:var(--radius-sm);color:var(--text);flex-shrink:0;transition:all .15s}.back-btn:active{background:var(--border-light);transform:scale(.95)}.level-info{display:flex;flex-direction:column;align-items:center;gap:2px;flex:1;min-width:0}.level-number{font-size:14px;font-weight:700;white-space:nowrap}.puzzle-name{font-weight:500;color:var(--text-secondary)}.level-size{font-size:11px;color:var(--text-tertiary);font-weight:600}.header-right{display:flex;flex-direction:column;align-items:flex-end;gap:4px;flex-shrink:0}.lives-display{display:flex;gap:3px}.life-heart{transition:transform .3s cubic-bezier(.34,1.56,.64,1);display:flex;align-items:center}.life-heart.lost{opacity:.3;transform:scale(.85)}.life-heart.active{animation:heartPop .3s ease}@keyframes heartPop{0%{transform:scale(1)}50%{transform:scale(1.3)}to{transform:scale(1)}}.timer{font-size:13px;font-weight:600;color:var(--text-secondary);font-variant-numeric:tabular-nums}.progress-bar-container{display:flex;align-items:center;gap:8px;padding:3px 12px 4px;background:var(--surface)}.progress-bar{flex:1;height:5px;background:var(--border-light);border-radius:3px;overflow:hidden}.progress-fill{height:100%;background:linear-gradient(90deg,var(--accent),#8B5CF6,var(--accent-dark));border-radius:3px;transition:width .3s cubic-bezier(.16,1,.3,1);position:relative}.progress-fill:after{content:"";position:absolute;right:0;top:0;bottom:0;width:12px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3));border-radius:0 3px 3px 0}.progress-text{font-size:11px;font-weight:600;color:var(--text-secondary);min-width:40px;text-align:right;font-variant-numeric:tabular-nums}.game-container{flex:1;display:flex;justify-content:center;align-items:center;padding:4px 2px;overflow:hidden}.game-canvas{background:var(--surface);border-radius:var(--radius-md);box-shadow:var(--shadow-md);touch-action:none;animation:canvasAppear .4s cubic-bezier(.16,1,.3,1) both;animation-delay:.1s}@keyframes canvasAppear{0%{opacity:0;transform:scale(.96)}to{opacity:1;transform:scale(1)}}.controls{display:flex;justify-content:space-around;align-items:center;padding:4px 8px calc(6px + var(--safe-bottom));background:var(--surface);position:relative}.controls:before{content:"";position:absolute;top:0;left:12px;right:12px;height:1px;background:linear-gradient(90deg,transparent,var(--border),transparent)}.control-btn{display:flex;flex-direction:column;align-items:center;gap:2px;padding:6px 10px;background:none;border:none;cursor:pointer;border-radius:var(--radius-md);transition:all .2s cubic-bezier(.25,.46,.45,.94);position:relative;color:var(--text);min-width:44px;min-height:44px}.control-btn:active:not(:disabled){background:var(--bg);transform:scale(.9);transition-duration:.1s}.control-btn:disabled{opacity:.35;cursor:not-allowed}.control-btn .icon{font-size:24px;line-height:1;display:flex;align-items:center;justify-content:center;color:var(--text)}.control-btn .label{font-size:10px;color:var(--text-secondary);font-weight:500}.control-btn .count{position:absolute;top:2px;right:4px;background:linear-gradient(135deg,var(--accent),var(--accent-dark));color:#fff;font-size:10px;font-weight:700;padding:2px 6px;border-radius:10px;line-height:1.2;box-shadow:0 2px 6px var(--accent-glow)}.mode-toggle{padding:4px}.mode-toggle-inner{display:flex;gap:2px;background:var(--bg);border-radius:var(--radius-md);padding:3px;border:1px solid var(--border-light)}.mode-option{display:flex;flex-direction:column;align-items:center;gap:2px;padding:6px 12px;border-radius:10px;transition:all .2s cubic-bezier(.25,.46,.45,.94);min-width:44px}.mode-option.active{background:var(--surface);box-shadow:var(--shadow-sm)}.mode-icon{font-size:18px;line-height:1;display:flex;align-items:center;justify-content:center}.mode-option .mode-label{font-size:10px;font-weight:600;color:var(--text-secondary)}.mode-option.active .mode-label{color:var(--accent);font-weight:700}.mode-fill .mode-option.active{background:var(--accent-light)}.mode-mark .mode-option.active{background:var(--danger-light)}.mode-mark .mode-option.active .mode-label{color:var(--danger)}.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:#00000080;display:flex;justify-content:center;align-items:center;z-index:100;animation:modalFadeIn .4s cubic-bezier(.16,1,.3,1) both;backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px)}@keyframes modalFadeIn{0%{opacity:0}to{opacity:1}}.modal-content{background:var(--surface);padding:36px 28px 28px;border-radius:var(--radius-xl);text-align:center;max-width:320px;width:90%;animation:modalSlideUp .5s cubic-bezier(.16,1,.3,1) both;animation-delay:.05s;box-shadow:0 24px 64px #00000040,0 0 0 1px #ffffff14;border:1px solid var(--border-light)}.modal-content.complete-modal{border:1px solid var(--success-light)}@keyframes modalSlideUp{0%{transform:translateY(40px) scale(.95);opacity:0}to{transform:translateY(0) scale(1);opacity:1}}.modal-icon{margin-bottom:16px;animation:emojiBounce .7s cubic-bezier(.34,1.56,.64,1) both;animation-delay:.2s;display:flex;align-items:center;justify-content:center}.modal-emoji{font-size:56px;margin-bottom:12px;animation:emojiBounce .7s cubic-bezier(.34,1.56,.64,1) both;animation-delay:.2s}@keyframes emojiBounce{0%{transform:scale(0) rotate(-10deg);opacity:0}50%{transform:scale(1.2) rotate(5deg)}to{transform:scale(1) rotate(0);opacity:1}}.modal-content h2{font-size:22px;font-weight:800;margin-bottom:4px;letter-spacing:-.3px}.puzzle-complete-name{font-size:14px;color:var(--text-secondary);margin-bottom:4px}.stars-display{display:flex;justify-content:center;gap:8px;margin:12px 0 4px}.star{animation:starPop .4s cubic-bezier(.34,1.56,.64,1) both;display:flex;align-items:center;filter:drop-shadow(0 2px 4px rgba(252,211,77,.3))}.star.empty{opacity:.3;filter:none}@keyframes starPop{0%{transform:scale(0) rotate(-45deg);opacity:0}to{transform:scale(1) rotate(0);opacity:1}}.result-stats{display:flex;align-items:center;justify-content:center;gap:20px;margin:16px 0;padding:16px;background:var(--bg);border-radius:var(--radius-lg)}.result-stat{display:flex;flex-direction:column;gap:4px}.result-stat-value{font-size:18px;font-weight:700;font-variant-numeric:tabular-nums}.result-stat-label{font-size:12px;color:var(--text-secondary)}.result-divider{width:1px;height:32px;background:var(--border)}.hint-earned-text{font-size:14px;font-weight:600;color:var(--success);margin-bottom:16px;animation:hintEarned .5s cubic-bezier(.34,1.56,.64,1) both;animation-delay:.6s;display:flex;align-items:center;justify-content:center;gap:6px}@keyframes hintEarned{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.game-over-modal h2{color:var(--danger)}.game-over-modal{border:1px solid var(--danger-light)}.game-over-desc{font-size:14px;color:var(--text-secondary);margin:8px 0 0;line-height:1.5}[data-theme=dark] .game-over-modal .secondary-btn{background:var(--surface-raised);border-color:var(--border);color:var(--text)}[data-theme=dark] .game-over-modal .revive-btn{box-shadow:0 4px 20px #22c55e73}.revive-btn{display:flex;align-items:center;justify-content:center;gap:8px;width:100%;padding:14px 20px;margin-bottom:10px;background:linear-gradient(135deg,#22c55e,#16a34a);color:#fff;border:none;border-radius:var(--radius-lg);font-size:15px;font-weight:700;cursor:pointer;transition:all .2s;box-shadow:0 4px 16px #22c55e59;min-height:52px;position:relative}.revive-btn--prominent{animation:revivePulse 2s ease-in-out infinite}.revive-badge{background:#ffffff40;padding:2px 8px;border-radius:10px;font-size:12px;font-weight:600}@keyframes revivePulse{0%,to{box-shadow:0 4px 16px #22c55e59}50%{box-shadow:0 4px 24px #22c55e8c}}.revive-btn:active{transform:scale(.96);filter:brightness(.95)}.modal-buttons{display:flex;gap:10px}.primary-btn{flex:1;padding:14px 20px;background:linear-gradient(135deg,var(--accent),var(--accent-dark));color:#fff;border:none;border-radius:var(--radius-lg);font-size:15px;font-weight:700;cursor:pointer;transition:all .2s cubic-bezier(.25,.46,.45,.94);box-shadow:var(--shadow-accent);min-height:48px}.primary-btn:active{transform:scale(.96);transition-duration:.1s;filter:brightness(.95)}.secondary-btn{flex:1;padding:14px 20px;background:var(--bg);color:var(--text);border:1px solid var(--border);border-radius:var(--radius-lg);font-size:15px;font-weight:600;cursor:pointer;transition:all .2s cubic-bezier(.25,.46,.45,.94);min-height:48px}.secondary-btn:active{background:var(--border-light);transform:scale(.96);transition-duration:.1s}.confetti-container{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:101;overflow:hidden}.confetti-particle{position:absolute;top:-12px;opacity:0;animation:confettiFall linear forwards}@keyframes confettiFall{0%{transform:translateY(0) rotate(0) scale(1);opacity:1}15%{opacity:1}85%{opacity:.7}to{transform:translateY(calc(100vh + 20px)) rotate(var(--confetti-rotate, 720deg)) scale(.5);opacity:0}}.share-btn{width:100%;padding:12px 20px;margin-top:10px;background:linear-gradient(135deg,#6c5ce7,#a855f7);color:#fff;border:none;border-radius:var(--radius-lg);font-size:14px;font-weight:700;cursor:pointer;transition:all .2s;min-height:44px;opacity:.9}.share-btn:hover{opacity:1}.share-btn:active{transform:scale(.96);opacity:.85}.share-btn:disabled{opacity:.6;cursor:not-allowed}.screen-transition{height:100%}.screen-transition.fade-in{animation:screenFadeIn .35s ease both}.screen-transition.slide-left-in{animation:slideLeftIn .4s cubic-bezier(.16,1,.3,1) both}.screen-transition.fade-out{animation:screenFadeOut .2s ease both}@keyframes screenFadeIn{0%{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}@keyframes screenFadeOut{0%{opacity:1;transform:translate(0)}to{opacity:0;transform:translate(-30px)}}@keyframes slideLeftIn{0%{opacity:0;transform:translate(40px)}to{opacity:1;transform:translate(0)}}.tutorial-screen{display:flex;flex-direction:column;height:100%;max-width:500px;margin:0 auto;background:var(--surface);padding:0 24px;position:relative}.tutorial-skip{position:absolute;top:16px;right:20px;background:none;border:none;font-size:14px;font-weight:600;color:var(--text-tertiary);cursor:pointer;padding:8px 12px;border-radius:var(--radius-sm);transition:color .2s,background .2s;z-index:2;min-height:44px;min-width:44px;display:flex;align-items:center;justify-content:center}.tutorial-skip:active{background:var(--bg);color:var(--text)}.tutorial-body{flex:1;display:flex;align-items:center;justify-content:center;overflow:hidden}.tutorial-card{text-align:center;padding:20px 0;max-width:340px;width:100%}.tutorial-card.tutorial-slide-next{animation:tutorialSlideNext .35s ease both}.tutorial-card.tutorial-slide-prev{animation:tutorialSlidePrev .35s ease both}@keyframes tutorialSlideNext{0%{opacity:0;transform:translate(40px)}to{opacity:1;transform:translate(0)}}@keyframes tutorialSlidePrev{0%{opacity:0;transform:translate(-40px)}to{opacity:1;transform:translate(0)}}.tutorial-illust{margin-bottom:24px;animation:tutorialEmojiPop .4s ease both;animation-delay:.1s;display:flex;justify-content:center}.tutorial-emoji{font-size:64px;margin-bottom:20px;animation:tutorialEmojiPop .4s ease both;animation-delay:.1s}@keyframes tutorialEmojiPop{0%{transform:scale(0);opacity:0}60%{transform:scale(1.15)}to{transform:scale(1);opacity:1}}.tutorial-title{font-size:22px;font-weight:800;letter-spacing:-.5px;margin-bottom:12px;color:var(--text)}.tutorial-desc{font-size:15px;line-height:1.6;color:var(--text-secondary);white-space:pre-line}.tutorial-example{margin-top:20px;display:flex;justify-content:center}.tutorial-mini-grid{display:inline-flex;flex-direction:column;align-items:center;gap:10px;background:var(--bg);padding:16px 20px;border-radius:var(--radius-lg);border:1px solid var(--border-light)}.mini-grid-row{display:flex;align-items:center;gap:4px}.mini-grid-cross{display:inline-flex;flex-direction:column;gap:4px}.cross-header{display:flex;gap:4px}.cross-spacer{width:24px}.mini-clue-col{width:32px;text-align:center;font-size:13px;font-weight:700;color:var(--text-secondary)}.mini-clue{width:24px;text-align:right;font-size:14px;font-weight:700;color:var(--accent);padding-right:4px;flex-shrink:0}.mini-cell{width:32px;height:32px;background:var(--surface);border-radius:6px;border:1.5px solid var(--border);display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;color:var(--danger);transition:all .3s ease}.mini-cell.filled{background:var(--cell-filled);border-color:var(--cell-filled);animation:miniCellPop .4s ease both}.mini-cell.filled:nth-child(2){animation-delay:.15s}.mini-cell.filled:nth-child(3){animation-delay:.25s}.mini-cell.filled:nth-child(4){animation-delay:.35s}.mini-cell.filled:nth-child(5){animation-delay:.45s}.mini-cell.highlight-cross{box-shadow:0 0 0 2px var(--accent),0 0 8px var(--accent-glow)}.mini-cell.x-mark{background:var(--danger-light);border-color:var(--danger);color:var(--danger);animation:miniCellPop .4s ease both}.mini-cell.x-mark:nth-child(4){animation-delay:.4s}.mini-cell.x-mark:nth-child(5){animation-delay:.55s}@keyframes miniCellPop{0%{opacity:0;transform:scale(.7)}60%{transform:scale(1.08)}to{opacity:1;transform:scale(1)}}.mini-caption{font-size:12px;color:var(--text-tertiary);font-weight:600}.controller-preview{flex-direction:row;gap:24px;padding:20px 24px}.ctrl-preview-dpad{display:flex;flex-direction:column;gap:2px;align-items:center}.ctrl-row{display:grid;grid-template-columns:repeat(3,28px);gap:2px}.ctrl-key{width:28px;height:28px;display:flex;align-items:center;justify-content:center;background:var(--surface);border:1px solid var(--border);border-radius:6px;font-size:12px;color:var(--text-secondary);box-shadow:var(--shadow-sm)}.ctrl-dot{width:28px;height:28px;display:flex;align-items:center;justify-content:center}.ctrl-dot:after{content:"";width:6px;height:6px;border-radius:50%;background:var(--text-tertiary)}.ctrl-preview-actions{display:flex;flex-direction:column;gap:6px;justify-content:center}.ctrl-action{padding:8px 14px;border-radius:8px;font-size:12px;font-weight:700;text-align:center}.ctrl-action.fill{border:1.5px solid var(--accent);color:var(--accent);background:var(--accent-light)}.ctrl-action.mark{border:1.5px solid var(--danger);color:var(--danger);background:var(--danger-light)}.tutorial-dots{display:flex;justify-content:center;gap:8px;margin-bottom:24px}.tutorial-dot{width:8px;height:8px;border-radius:4px;background:var(--border);transition:all .3s ease}.tutorial-dot.active{width:24px;background:var(--accent)}.tutorial-nav{display:flex;justify-content:space-between;gap:12px;padding-bottom:calc(32px + var(--safe-bottom))}.tutorial-btn-primary{flex:1;padding:16px 24px;background:linear-gradient(135deg,var(--accent),var(--accent-dark));color:#fff;border:none;border-radius:var(--radius-lg);font-size:16px;font-weight:700;cursor:pointer;transition:all .2s ease;box-shadow:var(--shadow-accent);min-height:48px}.tutorial-btn-primary:active{transform:scale(.97);filter:brightness(.95)}.tutorial-btn-secondary{padding:16px 24px;background:var(--bg);color:var(--text);border:1px solid var(--border);border-radius:var(--radius-lg);font-size:16px;font-weight:600;cursor:pointer;transition:all .2s ease;min-height:48px}.tutorial-btn-secondary:active{background:var(--border-light);transform:scale(.97)}@media(min-width:501px){.home-screen,.game-screen,.tutorial-screen,.settings-screen{border-left:1px solid var(--border);border-right:1px solid var(--border)}}.home-nav{display:flex;justify-content:space-around;padding:6px 12px calc(10px + var(--safe-bottom));background:var(--surface);position:fixed;bottom:0;left:0;right:0;max-width:500px;margin:0 auto;z-index:20;border-top:none}.home-nav:before{content:"";position:absolute;top:0;left:12px;right:12px;height:1px;background:linear-gradient(90deg,transparent,var(--border),transparent)}.home-nav-item{display:flex;flex-direction:column;align-items:center;gap:2px;padding:8px 24px;border-radius:var(--radius-md);cursor:pointer;transition:all .2s;-webkit-tap-highlight-color:transparent;min-height:44px}.home-nav-item:active{background:var(--bg);transform:scale(.95)}.home-nav-icon{display:flex;align-items:center;justify-content:center;width:28px;height:28px;color:var(--text-tertiary);transition:color .2s}.home-nav-label{font-size:11px;font-weight:600;color:var(--text-tertiary);transition:color .2s}.home-nav-item.active .home-nav-icon,.home-nav-item.active .home-nav-label{color:var(--accent)}.settings-screen{display:flex;flex-direction:column;height:100%;max-width:500px;margin:0 auto;background:var(--bg);overflow-y:auto;-webkit-overflow-scrolling:touch}.settings-header{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:var(--surface);position:sticky;top:0;z-index:10;position:relative}.settings-header:after{content:"";position:absolute;bottom:0;left:16px;right:16px;height:1px;background:linear-gradient(90deg,transparent,var(--border),transparent)}.settings-title{font-size:18px;font-weight:700}.settings-body{flex:1;padding:16px 16px 40px}.settings-section{margin-bottom:24px}.settings-section-title{font-size:12px;font-weight:700;color:var(--text-tertiary);margin-bottom:10px;padding-left:4px;text-transform:uppercase;letter-spacing:.5px}.settings-card{background:var(--surface);border-radius:var(--radius-lg);box-shadow:var(--shadow-sm);overflow:hidden}.settings-item{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;background:var(--surface);cursor:pointer;transition:all .15s;-webkit-tap-highlight-color:transparent;min-height:48px}.settings-card .settings-item{border-radius:0;margin-bottom:0}.settings-card .settings-item:not(:last-child){border-bottom:1px solid var(--border-light)}.settings-card .settings-item:first-child{border-radius:var(--radius-lg) var(--radius-lg) 0 0}.settings-card .settings-item:last-child{border-radius:0 0 var(--radius-lg) var(--radius-lg)}.settings-card .settings-item:only-child{border-radius:var(--radius-lg)}.settings-item:not(.settings-card .settings-item){border-radius:var(--radius-lg);margin-bottom:6px;box-shadow:var(--shadow-sm)}.settings-item:active{background:var(--bg)}.settings-item.disabled{opacity:.5}.settings-item-left{display:flex;align-items:center;gap:12px}.settings-item-icon{width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:var(--radius-sm);background:var(--bg);flex-shrink:0;color:var(--text-secondary)}.settings-item-text{display:flex;flex-direction:column;gap:2px}.settings-item-label{font-size:15px;font-weight:600;color:var(--text)}.settings-item-desc{font-size:12px;color:var(--text-secondary)}.settings-toggle{width:48px;height:28px;border-radius:14px;background:var(--border);position:relative;transition:background .25s;flex-shrink:0}.settings-toggle.on{background:var(--accent)}.settings-toggle-knob{width:22px;height:22px;border-radius:11px;background:#fff;position:absolute;top:3px;left:3px;transition:transform .25s cubic-bezier(.34,1.56,.64,1);box-shadow:0 1px 3px #00000026}.settings-toggle.on .settings-toggle-knob{transform:translate(20px)}.settings-action-btn{display:flex;align-items:center;gap:12px;width:100%;padding:14px 16px;background:var(--surface);border:none;border-radius:var(--radius-lg);font-size:15px;font-weight:600;color:var(--text);cursor:pointer;margin-bottom:6px;transition:all .15s;-webkit-tap-highlight-color:transparent;box-shadow:var(--shadow-sm);min-height:48px}.settings-action-btn:active{background:var(--bg);transform:scale(.98)}.settings-action-btn.danger{color:var(--danger)}.settings-action-btn .settings-item-icon{background:var(--bg)}.settings-action-btn.danger .settings-item-icon{background:var(--danger-light);color:var(--danger)}.canvas-wrapper{position:relative;display:flex;justify-content:center;align-items:center;width:100%;height:100%}.collection-preview-wrapper{display:flex;justify-content:center;margin:12px 0}.big-picture-canvas{box-shadow:var(--shadow-sm);border:1px solid var(--border-light)}.collection-diff-badge{display:inline-flex;align-items:center;gap:4px;margin-top:4px}.tile-grid{display:grid;gap:6px;margin-top:12px}.tile-cell{aspect-ratio:1;border-radius:var(--radius-sm);border:none;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;padding:0;min-width:44px;min-height:44px}.tile-available{background:var(--bg);border:1.5px solid var(--border);box-shadow:var(--shadow-sm)}.tile-available:active{transform:scale(.94);border-color:var(--accent)}.tile-completed{background:var(--surface);border:1.5px solid var(--success);box-shadow:0 2px 8px #10b98126;cursor:default}.tile-empty{background:transparent;cursor:default;border:1px dashed var(--border-light);opacity:.3}.tile-locked-content{display:flex;flex-direction:column;align-items:center;gap:2px}.tile-number{font-size:12px;font-weight:700;color:var(--text-secondary)}.tile-mini-canvas{border-radius:2px}.color-palette-bar{display:flex;justify-content:center;gap:8px;padding:8px 16px;background:var(--surface);border-bottom:1px solid var(--border-light)}.color-palette-btn{width:40px;height:40px;border-radius:var(--radius-md);border:2.5px solid transparent;background:var(--bg);cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;position:relative;padding:0;min-width:44px;min-height:44px}.color-palette-btn.selected{border-color:var(--palette-color);box-shadow:0 0 0 2px var(--bg),0 0 0 4px var(--palette-color);transform:scale(1.1)}.color-palette-btn:active{transform:scale(.92)}.color-palette-swatch{width:24px;height:24px;border-radius:6px;display:block}.color-palette-btn.selected .color-palette-swatch{width:20px;height:20px}@media(max-height:700px){.home-header{padding:32px 16px 12px}.app-title{font-size:22px}.stats-bar{padding:14px;margin:8px 16px}.game-header{padding:6px 10px}.controls{padding:4px 6px calc(6px + var(--safe-bottom))}.control-btn{padding:6px 8px}.progress-bar-container{padding:4px 10px}.game-container{padding:4px 2px}}@media(max-height:600px){.game-header{padding:4px 8px}.progress-bar-container{padding:2px 8px}.controls{padding:2px 4px calc(4px + var(--safe-bottom))}.game-container{padding:2px}}.game-header--compact{padding:4px 8px!important;min-height:36px}.game-header--compact .back-btn{width:28px;height:28px}.game-header--compact .level-number{font-size:13px}.game-header--compact .life-heart svg{width:14px;height:14px}.timer--compact{font-size:11px!important;color:var(--text-tertiary)!important}.controller-active .game-container{padding:2px}.controller-controls{flex-direction:column;padding:4px 6px calc(6px + var(--safe-bottom));background:var(--surface-raised, var(--surface));border-top:1px solid var(--border-light)}.controller-utility-bar{display:flex;justify-content:space-between;align-items:center;padding:2px 12px 6px}.control-btn-sm{display:flex;align-items:center;gap:4px;padding:4px 10px;border:1px solid var(--border-light);border-radius:var(--radius-sm);background:var(--bg);color:var(--text-secondary);font-size:12px;font-weight:500;cursor:pointer;-webkit-tap-highlight-color:transparent;touch-action:manipulation;min-height:28px}.control-btn-sm:active{background:var(--border-light)}.control-btn-sm:disabled{opacity:.4}.count-sm{background:var(--accent);color:#fff;font-size:10px;font-weight:700;padding:0 4px;border-radius:8px;min-width:16px;text-align:center;line-height:16px}.controller-pad{display:flex;justify-content:space-between;align-items:center;flex:1;padding:8px 16px 4px;gap:16px}.controller-left{flex:0 0 auto}.dpad-grid{display:grid;grid-template-columns:repeat(3,min(44px,calc((50vw - 40px) / 3)));grid-template-rows:repeat(3,min(44px,calc((50vw - 40px) / 3)));gap:2px}.dpad-btn{width:min(44px,calc((50vw - 40px) / 3));height:min(44px,calc((50vw - 40px) / 3));border:none;border-radius:var(--radius-sm);background:var(--bg);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .1s;-webkit-tap-highlight-color:transparent;touch-action:manipulation;box-shadow:var(--shadow-sm);border:1px solid var(--border-light)}.dpad-btn:active{background:var(--border-light);transform:scale(.92)}.dpad-center-dot{display:flex;align-items:center;justify-content:center}.dpad-center-dot:after{content:"";width:8px;height:8px;border-radius:50%;background:var(--text-secondary);opacity:.3}.controller-right{display:flex;flex-direction:column;gap:8px;align-items:center;flex:0 1 auto}.action-btn{width:min(80px,calc(50vw - 40px));height:min(50px,calc((50vw - 40px)/2));min-width:64px;min-height:40px;border-radius:12px;border:2px solid var(--border);background:var(--bg);display:flex;align-items:center;justify-content:center;gap:4px;cursor:pointer;transition:all .1s;-webkit-tap-highlight-color:transparent;touch-action:manipulation}.action-btn-label{font-size:13px;font-weight:600;letter-spacing:-.3px}.action-fill{border-color:var(--accent);color:var(--accent)}.action-fill:active{background:var(--accent);color:#fff;transform:scale(.95);opacity:.8}.action-fill:active svg path{stroke:#fff}.action-mark{border-color:var(--danger);color:var(--danger)}.action-mark:active{background:var(--danger);color:#fff;transform:scale(.95);opacity:.8}.action-mark:active svg path{stroke:#fff}.mode-switch-btn{flex-shrink:0}.section-header{display:flex;align-items:center;justify-content:space-between;cursor:pointer;padding:6px 0;-webkit-tap-highlight-color:transparent;-webkit-user-select:none;user-select:none}.section-header-left,.section-header-right{display:flex;align-items:center;gap:8px}.section-progress-text{font-size:12px;font-weight:600;color:var(--text-tertiary);font-variant-numeric:tabular-nums}.section-chevron{display:flex;align-items:center;justify-content:center;width:24px;height:24px;color:var(--text-tertiary);transition:transform .25s cubic-bezier(.25,.46,.45,.94)}.section-chevron.open{transform:rotate(180deg)}.section-body{overflow:hidden;transition:max-height .3s cubic-bezier(.25,.46,.45,.94),opacity .25s ease}.section-body.collapsed{max-height:0;opacity:0;pointer-events:none}.section-body.expanded{max-height:1000px;opacity:1}.daily-challenge-card{background:var(--surface);border-radius:16px;padding:16px;margin:8px 0 12px;border:1.5px solid var(--border);cursor:pointer;transition:transform .15s ease,box-shadow .15s ease}.daily-challenge-card:active{transform:scale(.98)}.daily-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.daily-title-row{display:flex;align-items:center;gap:8px}.daily-title{font-size:15px;font-weight:700;color:var(--text)}.daily-badge{font-size:12px;font-weight:600;color:var(--success);background:var(--success-light);padding:2px 8px;border-radius:10px}.daily-streak{display:flex;align-items:center;gap:4px;font-size:13px;font-weight:600;color:#f97316}.daily-progress{display:flex;align-items:center;gap:8px;margin-bottom:10px}.daily-progress-bar{flex:1;height:6px;background:var(--border);border-radius:3px;overflow:hidden}.daily-progress-fill{height:100%;background:linear-gradient(90deg,var(--accent),#a855f7);border-radius:3px;transition:width .3s ease}.daily-progress-text{font-size:12px;font-weight:600;color:var(--text-secondary);min-width:32px;text-align:right}.daily-cta{font-size:13px;color:var(--text-secondary);margin-bottom:10px}.daily-calendar{display:flex;justify-content:space-between;gap:4px}.daily-cal-day{display:flex;flex-direction:column;align-items:center;gap:4px;flex:1}.daily-cal-name{font-size:11px;color:var(--text-tertiary);font-weight:500}.daily-cal-circle{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:var(--border-light);transition:all .2s ease}.daily-cal-circle.current{border:2px solid var(--accent);background:var(--accent-light)}.daily-cal-circle.done{background:var(--accent)}.daily-cal-num{font-size:12px;font-weight:600;color:var(--text-secondary)}.daily-cal-day.today .daily-cal-name{color:var(--accent);font-weight:700}.daily-cal-day.completed .daily-cal-num{color:#fff}.daily-game-title{display:flex;align-items:center;gap:6px}.daily-game-date{font-size:11px;color:var(--text-tertiary)}.toast-container{position:fixed;top:0;left:0;right:0;z-index:9999;display:flex;justify-content:center;pointer-events:none;transform:translateY(-100%);transition:transform .35s cubic-bezier(.34,1.56,.64,1)}.toast-container.toast-visible{transform:translateY(0)}.toast-container.toast-leaving{transform:translateY(-100%);transition:transform .3s ease-in}.toast-content{display:flex;align-items:center;gap:10px;margin-top:calc(env(safe-area-inset-top,0px) + 12px);padding:12px 20px;background:var(--card-bg);border:1px solid var(--border);border-radius:16px;box-shadow:0 8px 32px #00000026;min-width:200px;max-width:calc(100vw - 40px)}[data-theme=dark] .toast-content{box-shadow:0 8px 32px #0006}.toast-icon{font-size:24px;flex-shrink:0}.toast-text{font-size:14px;font-weight:600;color:var(--text-primary);line-height:1.3}.stats-screen{min-height:100vh;min-height:100dvh;background:var(--bg);display:flex;flex-direction:column}.stats-tab-bar{display:flex;padding:0 20px;gap:4px;background:var(--bg);border-bottom:1px solid var(--border)}.stats-tab{flex:1;padding:12px 0;background:none;border:none;border-bottom:3px solid transparent;font-size:14px;font-weight:600;color:var(--text-secondary);cursor:pointer;transition:all .2s}.stats-tab.active{color:var(--accent);border-bottom-color:var(--accent)}.stats-body{flex:1;overflow-y:auto;padding:16px 20px 40px;-webkit-overflow-scrolling:touch}.stats-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}.stat-card{background:var(--card-bg);border:1px solid var(--border);border-radius:16px;padding:16px;display:flex;flex-direction:column;align-items:center;text-align:center;gap:4px}.stat-card-icon{font-size:28px;margin-bottom:4px}.stat-card-value{font-size:24px;font-weight:800;color:var(--text-primary);line-height:1.2}.stat-card-sub{font-size:14px;font-weight:500;color:var(--text-secondary);margin-left:2px}.stat-card-label{font-size:12px;font-weight:500;color:var(--text-secondary);margin-top:2px}.stats-section-wide{grid-column:1 / -1;background:var(--card-bg);border:1px solid var(--border);border-radius:16px;padding:16px}.stats-section-title{font-size:14px;font-weight:700;color:var(--text-primary);margin-bottom:12px}.stats-avg-grid{display:flex;flex-wrap:wrap;gap:8px}.stats-avg-item{flex:1;min-width:70px;display:flex;flex-direction:column;align-items:center;gap:4px;background:var(--bg);border-radius:10px;padding:10px 8px}.stats-avg-size{font-size:12px;font-weight:600;color:var(--text-secondary)}.stats-avg-time{font-size:16px;font-weight:700;color:var(--accent)}.achievements-list{display:flex;flex-direction:column;gap:8px}.achievement-item{display:flex;align-items:center;gap:12px;background:var(--card-bg);border:1px solid var(--border);border-radius:14px;padding:14px 16px;transition:opacity .2s}.achievement-item.locked{opacity:.55}.achievement-icon-wrap{width:44px;height:44px;display:flex;align-items:center;justify-content:center;background:var(--bg);border-radius:12px;flex-shrink:0}.achievement-icon{font-size:24px}.achievement-icon.grayscale{filter:grayscale(1);opacity:.5}.achievement-info{flex:1;min-width:0}.achievement-name{font-size:15px;font-weight:700;color:var(--text-primary);line-height:1.3}.achievement-desc{font-size:12px;color:var(--text-secondary);margin-top:2px}.achievement-date{font-size:11px;color:var(--text-tertiary);margin-top:2px}.achievement-status{font-size:20px;flex-shrink:0}
